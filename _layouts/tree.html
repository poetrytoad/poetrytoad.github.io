<!DOCTYPE html>
<html>
<head>
  <title>{{ page:collection }}: {{ site.data.[page:collection].[page.title].name }}</title>
  <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/css/tree.css" />
  <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - {{ site.description }}" href="{{ site.baseurl }}/feed.xml" />

</head>
<body>

  <nav>
    <h1>
      <a href="#" class="path">&larr;</a>
      Family › {{ page:collection }}
    </h1>
    {% for a in site.data.[page:collection].[page.title].anc reversed %}
    <a href="{{ a }}"><span class="{{ site.data.[page:collection].[a].gen }}">{{ site.data.[page:collection].[a].name }}</span></a> ›
    {% endfor %}
    <a><span class="{{ site.data.[page.title].gen }}">{{ site.data.[page:collection].[page.title].name }}</span></a>
  </nav>

  <article>
      <h1>
        {% assign h=site.data.[page:collection].[page.title] %}
        {% include loop.liquid p=h %}
      </h1>

    {% for p1 in site.data.[page:collection].[page.title].family.children %}

      {% if forloop.first %}<ul>{% endif %}
      <li>
        {% if p1.import %}
          {% assign q=site.data.[page:collection].[p1.import] %}
          {% if site.[page:collection].[p1.import].title %}
            {% assign l=p1.import %}
          {% endif %}
        {% else %}
          {% assign q=p1 %}
          {% assign l=false %}
        {% endif %}
        {% include loop.liquid p=q treelink=l %}

        {% for p2 in q.family.children %}

        {% if forloop.first %}<ul>{% endif %}
          <!-- impement this for subnested -->
          <li>
            {% include loop.liquid p=p2 %}
            {% for p3 in p2.family.children %}
            {% if forloop.first %}<ul>{% endif %}
              <li>
                {% include loop.liquid p=p3 %}
                {% for p4 in p3.family.children %}
                {% if forloop.first %} <ul>{% endif %}
                  <li>
                    {% include loop.liquid p=p4%}
                    {% for p5 in p4.family.children %}
                    {% if forloop.first %}<ul>{% endif %}
                      <li>
                        {% include loop.liquid p=p5%}
                      </li>
                      {% if forloop.last %}</ul>{% endif %} {% endfor %}
                  </li>
                  {% if forloop.last %}</ul>{% endif %} {% endfor %}
              </li>
              {% if forloop.last %}</ul>{% endif %} {% endfor %}
          </li>
          {% if forloop.last %}</ul>{% endif %} {% endfor %}
      </li>
      {% if forloop.last %}</ul>{% endif %} {% endfor %}
  </article>

  <script src="{{ site.baseurl }}/js/fold.js"></script>

  <article>
    {{ content }}
  </article>

</body>
</html>
